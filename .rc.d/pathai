#!/bin/bash
#
# PathAI and Mac OSX specific things.

# GNU Utils.
alias find="gfind"
alias ls="gls"
alias mkdir="gmkdir"

# Various things.
alias dnsfix="sudo killall -HUP mDNSResponder"
alias listen="lsof -i -P | grep -i listen"
alias pip="pip3"
alias python="python3"
alias vlogin="vault login -method=okta username=$USER@pathai.com"
alias xclip="pbcopy"

# Environment.
export PATH="$PATH:/Users/matt.coleman/Library/Python/3.9/bin"
export VAULT_ADDR="https://vault-server.services.pathai.com"

# Reset commits to my PathAI email.
pathai_git_reset_author() {
  git filter-branch --force --env-filter "
      GIT_AUTHOR_NAME='Matthew Coleman'
      GIT_AUTHOR_EMAIL='matt.coleman@pathai.com'
      GIT_COMMITTER_NAME='Matthew Coleman'
      GIT_COMMITTER_EMAIL='matt.coleman@pathai.com'
    " HEAD
}

# Log-in to PathAI Vault.
pathai_vault_login() {
  vault login -method okta username=matt.coleman@pathai.com 
}

# Create the SSH key needed to SSH.
pathai_ssh_cert() {
  vault write \
    -field=signed_key \
    ssh/sign/sre \
    public_key=@$HOME/.ssh/pathai.pub > \
    ~/.ssh/pathai-vault-cert.pub && \
  chmod 600 ~/.ssh/pathai-vault-cert.pub
}
